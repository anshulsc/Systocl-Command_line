#!/bin/bash

# sysopctl - A command-line utility for system administration

VERSION="v0.1.0"

# Function to display help message
display_help() {
    echo "Usage: sysopctl [OPTION]... [COMMAND]..."
    echo "A tool to simplify system administration tasks."
    echo ""
    echo "Options:"
    echo "  --help                  Display this help message and exit."
    echo "  --version               Display the version and exit."
    echo ""
    echo "Commands:"
    echo "  service list            List all active services."
    echo "  service start NAME      Start a service."
    echo "  service stop NAME       Stop a service."
    echo "  system load             Display system load averages."
    echo "  disk usage              Show disk usage statistics."
    echo "  process monitor         Display real-time process activity."
    echo "  logs analyze            Analyze recent critical log entries."
    echo "  backup PATH             Backup the specified path."
    echo ""
    echo "Examples:"
    echo "  sysopctl service list"
    echo "  sysopctl service start apache2"
    echo "  sysopctl backup /etc"
}

# Function to display version information
display_version() {
    echo "sysopctl version ${VERSION}"
}

list_services() {
# Set the PYTHONWARNINGS environment variable to ignore DeprecationWarnings
  export PYTHONWARNINGS="ignore:invalid escape sequence:DeprecationWarning"

  # Run systemctl
  systemctl list-units --type=service --state=active

  # Unset the environment variable (optional, for cleanup)
  unset PYTHONWARNINGS
}


# Function to display system load
display_system_load() {
    uptime
}

# Main logic (for now, just handle --help and --version)
if [[ $# -eq 0 ]]; then
    display_help
    exit 1
fi

case "$1" in
    --help)
        display_help
        ;;
    --version)
        display_version
        ;;
    service)
        if [[ "$2" == "list" ]]; then
            list_services
        else
            echo "Invalid usage of service command. Use 'sysopctl service list'."
            exit 1
        fi
        ;;

     system)
        if [[ "$2" == "load" ]]; then
            display_system_load
        else
            echo "Invalid usage of system command. Use 'sysopctl system load'."
            exit 1
        fi
        ;;

    *)
        echo "Invalid option or command. Use --help for usage."
        exit 1
        ;;
esac

exit 0